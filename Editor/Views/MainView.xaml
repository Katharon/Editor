<Page x:Class="Editor.Views.MainView"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
      xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
      xmlns:viewModels="clr-namespace:Editor.ViewModels"
      mc:Ignorable="d" 
      d:DesignHeight="450" d:DesignWidth="800"
      d:DataContext="{d:DesignInstance Type=viewModels:MainViewModel, IsDesignTimeCreatable=False}"
      Title="MainView">

    <Page.InputBindings>
        <KeyBinding Modifiers="Ctrl" Key="N" Command="{Binding NewCommand}" />
        <KeyBinding Modifiers="Ctrl" Key="O" Command="{Binding OpenCommand}" />
        <KeyBinding Modifiers="Ctrl" Key="S" Command="{Binding SaveCommand}" />
        <KeyBinding Modifiers="Ctrl+Shift" Key="S" Command="{Binding SaveAsCommand}" />
        <KeyBinding Modifiers="Alt" Key="F4" Command="{Binding ExitCommand}" />
    </Page.InputBindings>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="30" />
            <RowDefinition Height="*" />
            <RowDefinition Height="30" />
        </Grid.RowDefinitions>

        <!-- Title Bar -->
        <Border Grid.Row="0" BorderThickness="0,0,0,1" Background="#444">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="auto" />
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="auto" />
                </Grid.ColumnDefinitions>

                <Menu Grid.Column="0">
                    <MenuItem Header="_Datei" Height="30">
                        <MenuItem Header="_Neu" InputGestureText="Strg+N" Command="{Binding NewCommand}" />
                        <MenuItem Header="_Öffnen" InputGestureText="Strg+O" Command="{Binding OpenCommand}" />
                        <Separator />
                        <MenuItem Header="_Speichern" InputGestureText="Strg+S" Command="{Binding SaveCommand}" />
                        <MenuItem Header="Speichern _unter" InputGestureText="Strg+Umschalt+S" Command="{Binding SaveAsCommand}" />
                        <Separator />
                        <MenuItem Header="_Beenden" InputGestureText="Alt+F4" Command="{Binding ExitCommand}" />
                    </MenuItem>

                    <MenuItem Header="_Bearbeiten">
                        <MenuItem Header="_Rückgängig" InputGestureText="Strg+Z" Command="ApplicationCommands.Undo" />
                        <MenuItem Header="Wieder_herstellen" InputGestureText="Strg+Y" Command="ApplicationCommands.Redo" />
                    </MenuItem>

                    <MenuItem Header="_Extensions">
                        <MenuItem Header="Extension-_Verwaltung" InputGestureText="Strg+V" Command="{Binding ManageExtensionSetsCommand}" />
                        <MenuItem Header="Dateitypen-_Mapping" InputGestureText="Strg+M" Command="{Binding ManageMappingsCommand}" />
                    </MenuItem>

                    <MenuItem Header="_Hilfe">
                        <MenuItem Header="_Informationen" InputGestureText="Strg+I" Command="{Binding AboutCommand}" />
                    </MenuItem>
                </Menu>

                <StackPanel Grid.Column="2" Orientation="Horizontal">
                    <Button Width="45" Content="-" Click="Minimize_Click" />
                    <Button Width="45" Content="🗖" Click="Maximize_Click" />
                    <Button Width="45" Content="✖" Click="Close_Click" />
                </StackPanel>
            </Grid>
        </Border>

        <!-- Main Content -->
        <Grid Grid.Row="1" Background="#444">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="250" />
                <ColumnDefinition Width="*" />
            </Grid.ColumnDefinitions>

            <!-- Side Bar -->
            <Border Grid.Column="0" BorderBrush="#444" BorderThickness="0,0,1,0">
                <StackPanel Orientation="Vertical">
                    <!-- Extension Set Header -->
                    <TextBlock Text="Extension-Sets" />

                    <!-- Extension Sets -->
                    <ListBox ItemsSource="{Binding ExtensionSets}" SelectedItem="{Binding SelectedExtensionSet}">
                        <ListBox.ItemTemplate>
                            <DataTemplate>
                                <DockPanel>
                                    <CheckBox IsChecked="{Binding IsActive}" />
                                    <TextBlock Text="{Binding Name}" />
                                </DockPanel>
                            </DataTemplate>
                        </ListBox.ItemTemplate>
                    </ListBox>
                </StackPanel>
            </Border>

            <!-- Tab Control -->
            <TabControl Grid.Column="1" Background="#333" ItemsSource="{Binding Documents}" SelectedItem="{Binding ActiveDocument}">
                <!-- Tab Header -->
                <TabControl.ItemTemplate>
                    <DataTemplate>
                        <TextBlock Text="{Binding FileName}" />
                    </DataTemplate>
                </TabControl.ItemTemplate>

                <!-- Tab Content -->
                <TabControl.ContentTemplate>
                    <DataTemplate>
                        <TextBox Text="{Binding Content, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" TextChanged="Editor_TextChanged" />
                    </DataTemplate>
                </TabControl.ContentTemplate>
            </TabControl>
        </Grid>

        <!-- Footer Bar -->
        <Border Grid.Row="2" BorderThickness="0,1,0,0" Background="#444">
            <StatusBar Background="Transparent">
                <!-- Status Message -->
                <StatusBarItem>
                    <TextBlock Text="{Binding StatusMessage}" />
                </StatusBarItem>

                <!-- Caret Position -->
                <StatusBarItem HorizontalAlignment="Right">
                    <TextBlock Text="{Binding CaretPosition}" />
                </StatusBarItem>
            </StatusBar>
        </Border>
    </Grid>

</Page>
